window.customify=window.customify||parent.customify||{},function(e,t,n){void 0===t.colorPalettes&&(t.colorPalettes={}),_.extend(t.colorPalettes,function(){const o=n.customize;let s;const i="light",c={},r="#_customize-input-sm_dark_color_primary_slider_control",a="#_customize-input-sm_dark_color_secondary_slider_control",l="#_customize-input-sm_dark_color_tertiary_slider_control";let d=!1;const u=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];function f(e){return isNaN(e)?"00":u[(e-e%16)/16]+u[e%16]}function m(e){return"#"+f(e[0])+f(e[1])+f(e[2])}function h(e){return m(P(e.hue,e.saturation,e.lightness))}function p(e){let t=0,n=0,o=0,s=0;/^#([A-Fa-f0-9]{3,4}){1,2}$/.test(e)&&(3===(e=e.substring(1).split("")).length&&(e=[e[0],e[0],e[1],e[1],e[2],e[2],"F","F"]),4===e.length&&(e=[e[0],e[0],e[1],e[1],e[2],e[2],e[3],e[3]]),t=parseInt([e[0],e[1]].join(""),16),n=parseInt([e[2],e[3]].join(""),16),o=parseInt([e[4],e[5]].join(""),16),s=parseInt([e[6],e[7]].join(""),16));const i=g(t,n,o);return{red:t,green:n,blue:o,alpha:s,hue:i[0],saturation:i[1],lightness:i[2],luma:.2126*t+.7152*n+.0722*o}}function g(e,t,n){e/=255,t/=255,n/=255;const o=Math.max(e,t,n),s=Math.min(e,t,n);let i,c,r=(o+s)/2;if(o==s)i=c=0;else{const a=o-s;switch(c=r>.5?a/(2-o-s):a/(o+s),o){case e:i=(t-n)/a+(t<n?6:0);break;case t:i=(n-e)/a+2;break;case n:i=(e-t)/a+4}i/=6}return[i,c,r]}const v=()=>{_.each(t.colorPalettes.masterSettingIds,(function(e){const t=o(e);if(void 0!==t){const n=t();c[e]=S(n)}}))},y=e=>c[e],k=function(){_.each(t.colorPalettes.masterSettingIds,(function(e){if(void 0!==s[e]){const n=s[e],i=o(e);_.isUndefined(n.connected_fields)||(t.colorPalettes.connectedFieldsCallbacks[e]=function(e,t){return function(n,s){const i=y(t);_.each(e.connected_fields,(function(e){if(_.isUndefined(e)||_.isUndefined(e.setting_id)||!_.isString(e.setting_id))return;const t=o(e.setting_id);_.isUndefined(t)||t.set(i)})),q();const c=o(t+"_final");_.isUndefined(c)||(_.isUndefined(e.connected_fields)||_.isEmpty(e.connected_fields)?c.set(""):c.set(i))}}(n,e),i.bind(t.colorPalettes.connectedFieldsCallbacks[e]),_.each(n.connected_fields,(function(e){const n=e.setting_id,s=o(n);void 0!==s&&(t.colorPalettes.connectedFieldsCallbacks[n]=D,s.bind(t.colorPalettes.connectedFieldsCallbacks[n]))})))}}))},b=function(){_.each(t.colorPalettes.connectedFieldsCallbacks,(function(e,t){o(t).unbind(e)})),t.colorPalettes.connectedFieldsCallbacks={}},F=e=>t.colorPalettes.variations.hasOwnProperty(e)?t.colorPalettes.variations[e]:i,C=()=>{const e=[];return _.each(t.colorPalettes.masterSettingIds,(function(t){const n=o(t)();e.push(n)})),e};function P(e,t,n){let o,s,i;if(0==t)o=s=i=n;else{const c=function(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e},r=n<.5?n*(1+t):n+t-n*t,a=2*n-r;o=c(a,r,e+1/3),s=c(a,r,e),i=c(a,r,e-1/3)}return[Math.round(255*o),Math.round(255*s),Math.round(255*i)]}function U(e,t,n,o){return t[e]*(1-o)+n[e]*o}function w(e,t,n){return e*(1-n)+t*n}const S=(t,n)=>{n=void 0===n?e('[name*="sm_palette_filter"]:checked').val():n;let o=p(t);const s=C(),i=s.slice(0,3),c=s.slice(3,6);L(A(s)),L(A(i)),L(A(c));if("vivid"===n)return o=P(o.hue,w(o.saturation,1,.5),o.lightness),m(o);if("warm"===n&&t!==s[0]){let e=p("#704214");return e.saturation=U("saturation",e,o,1),e.lightness=U("lightness",e,o,1),e=p(h(e)),o.saturation=.75*o.saturation,o=p(h(o)),a=e,l=(l=.75)||.5,(r=o).red=parseInt(a.red*l+r.red*(1-l),10),r.green=parseInt(a.green*l+r.green*(1-l),10),r.blue=parseInt(a.blue*l+r.blue*(1-l),10),o=p(m([r.red,r.green,r.blue])),o.lightness=U("lightness",o,p(o.lightness>.5?"#FFF":"#000"),.2),h(o)}var r,a,l;if("softer"===n)return o.saturation=U("saturation",o,p("#FFF"),.3),o.lightness=U("lightness",o,p("#FFF"),.1),h(o);if("pastel"===n)return o.saturation=U("saturation",o,p("#FFF"),.6),o.lightness=U("lightness",o,p("#FFF"),.2),h(o);if("greyish"===n)return o=P(o.hue,w(o.saturation,0,.8),o.lightness),m(o);if("clarendon"===n)return t===s[0]||t===s[1]||t===s[2]?(o=P(o.hue,w(o.saturation,1,.3),o.lightness),m(o)):(t!==s[3]&&t!==s[4]&&t!==s[5]||(o.lightness=U("lightness",o,p("#000"),.4)),t!==s[6]&&t!==s[7]&&t!==s[8]||(o.lightness=U("lightness",o,p("#FFF"),.4)),h(o));if("cold"===n&&t!==s[0]){const e=.55;o.saturation=U("saturation",o,p("#FFF"),.4),o.hue=(o.hue-e)/18+e,o=p(h(o));const t=g(o.red,o.green,o.blue);return o.hue=t[0],o.saturation=w(t[1],1,.1),o.lightness=U("lightness",o,p(o.lightness>.5?"#FFF":"#000"),.2),h(o)}return"dumb"===n?t===s[1]||t===s[2]?(o=p(s[0]),o.lightness=U("lightness",o,p("#000"),.2),o.saturation=U("saturation",o,p("#000"),.2),t===s[2]&&(o.lightness=U("lightness",o,p("#000"),.2),o.saturation=U("saturation",o,p("#000"),.2)),h(o)):(o.hue=p(s[0]).hue,h(o)):"mayfair"===n?t===s[1]||t===s[2]?(o=p(s[0]),o.hue=(o.hue+.05)%1,t===s[2]&&(o.hue=(o.hue+.05)%1),h(o)):(o.hue=p(s[0]).hue,h(o)):"sierra"===n?t===s[1]||t===s[2]?(o=p(s[0]),o.hue=(o.hue+.95)%1,t===s[2]&&(o.hue=(o.hue+.95)%1),h(o)):(o.hue=p(s[0]).hue,h(o)):t},j=function(){_.each(t.colorPalettes.masterSettingIds,(function(t){e(".c-color-palette").find(".sm-color-palette__color."+t).css("color",y(t))}))},I=function(){_.each(t.colorPalettes.masterSettingIds,(function(t){const n=o(t)();e(".c-color-palette").find(".sm-color-palette__color."+t).css("color",n)}))},O=function(){e(this).trigger("customify:preset-change"),v(),Q()},z=_.debounce((()=>{let n=e();_.each(t.colorPalettes.masterSettingIds,(function(t){if(void 0!==s[t]){const o=s[t];_.isUndefined(o.connected_fields)||_.each(o.connected_fields,(function(t){const o=t.setting_id.match(/\[(.*?)\]/);if(o){const t=o[1],s=e(".customize-control-color").filter('[id*="'+t+'"]').find(".wp-color-picker");n=n.add(s)}}))}})),n.iris({palettes:C()})}),30),D=_.debounce((()=>{const n=[];let i;_.each(t.colorPalettes.masterSettingIds,(function(e){let t=s[e].connected_fields;const i=o(e)();let c=!1;_.isUndefined(t)||Array.isArray(t)||(t=Object.keys(t).map((function(e){return t[e]}))),!_.isUndefined(t)&&t.length&&(_.each(t,(function(e){const t=e.setting_id,n=o(t);if(void 0!==n){const e=n();"string"==typeof e&&e.toLowerCase()!==S(i).toLowerCase()&&(c=!0)}})),c&&n.push(e))})),i="."+n.join(", ."),e(".c-color-palette .color").removeClass("altered"),n.length&&e(".c-color-palette .color").filter(i).addClass("altered")}),30),N=_.debounce((()=>{const n=[];let o;_.each(t.colorPalettes.masterSettingIds,(function(e){const t=s[e].connected_fields;_.isUndefined(t)||_.isEmpty(t)||n.push(e)})),o=_.isEmpty(n)?"*":"."+n.join(", ."),e(".sm-palette-filter .color").addClass("hidden").filter(o).removeClass("hidden"),e(".sm-color-palette__color").addClass("hidden").filter(o).removeClass("hidden"),e(".js-color-palette .palette__item").addClass("hidden").filter(o).removeClass("hidden")}),30),x=()=>{D(),N(),z(),j()},J=(e,t)=>{const n=JSON.parse(JSON.stringify(e)),o=JSON.parse(JSON.stringify(e));return _.each(t,(function(e,t){if(void 0!==n[t]){let s=[];e instanceof Array&&_.each(e,(function(e){let t;_.isUndefined(o[e].connected_fields)&&(o[e].connected_fields=[]),t=Object.values(o[e].connected_fields),s=s.concat(t)})),n[t].connected_fields=Object.keys(s).map((function(e){return s[e]}))}})),_.clone(n)},M=(e,t,n,o)=>{const s=_.clone(e);if(!_.isUndefined(s[n])&&!_.isUndefined(s[t])){_.isUndefined(s[t].connected_fields)&&(s[t].connected_fields=[]),_.isUndefined(s[n].connected_fields)&&(s[n].connected_fields=[]);const e=Object.values(s[t].connected_fields),i=Object.values(s[n].connected_fields).concat(e),c=Math.round(o*i.length);let r=i.slice(0,c);const a=i.slice(c);r=Object.keys(r).map((function(e){return r[e]})),r=Object.keys(r).map((function(e){return r[e]})),s[n].connected_fields=r,s[t].connected_fields=a}return s},E=()=>{let n=JSON.parse(JSON.stringify(t.settingsClone));const i=e('[name*="sm_color_diversity"]'),c=e('[name*="sm_coloration_level"]'),d=!!i.length,u=void 0!==i.filter(":checked").data("default"),f=!d||u,m=!!c.length,h=void 0!==e('[name*="sm_coloration_level"]:checked').data("default"),p=!m||h,g=d?e('[name*="sm_color_diversity"]:checked').val():o("sm_color_diversity")();if(!f||!p){const t=e(r).val()/100,o=e(a).val()/100,s=e(l).val()/100;n=M(n,"sm_dark_primary","sm_color_primary",t),n=M(n,"sm_dark_secondary","sm_color_secondary",o),n=M(n,"sm_dark_tertiary","sm_color_tertiary",s);const i=F("color_diversity_low");n=J(n,i),"medium"===g&&(n=M(n,"sm_color_primary","sm_color_secondary",.5)),"high"===g&&(n=M(n,"sm_color_primary","sm_color_secondary",.67),n=M(n,"sm_color_secondary","sm_color_tertiary",.5))}const v=e('[name*="sm_shuffle_colors"]:checked').val();if("default"!==v){const e=F("shuffle_"+v);n=J(n,e)}if("on"===e('[name*="sm_dark_mode_control"]:checked').val()){const e=F("dark");n=J(n,e)}_.each(t.colorPalettes.masterSettingIds,(function(e){s[e]=n[e]}))},A=function(e){const t=[];return _.each(e,(function(e){t.push(p(e))})),t},L=function(e){const t={red:0,green:0,blue:0,alpha:0,hue:0,saturation:0,lightness:0,luma:0};for(let n=0;n<e.length;n++){const o=e[n];for(let e in t)t[e]+=o[e]}for(let n in t)t[n]/=e.length;return t},B=()=>{const n=e('[name*="sm_coloration_level"]:checked').val();if(void 0!==e('[name*="sm_coloration_level"]:checked').data("default")){const n=["sm_dark_color_primary_slider","sm_dark_color_secondary_slider","sm_dark_color_tertiary_slider"];_.each(n,(function(n){const s=t.config.settings[n];o(n).set(s.default),e("#_customize-input-"+n+"_control ").val(s.default)}))}else{const t=parseFloat(n);e("#_customize-input-sm_dark_color_primary_slider_control, #_customize-input-sm_dark_color_secondary_slider_control, #_customize-input-sm_dark_color_tertiary_slider_control").val(t)}Q()},Q=()=>{E(),b(),k(),x(),_.each(t.colorPalettes.masterSettingIds,(function(e){if(void 0!==o(e)){let t=s[e];const n=y(e);_.each(t.connected_fields,(function(e){if(_.isUndefined(e)||_.isUndefined(e.setting_id)||!_.isString(e.setting_id))return;const t=o(e.setting_id);_.isUndefined(t)||t.set(n)}));const i=o(e+"_final");_.isUndefined(i)||(_.isUndefined(t.connected_fields)||_.isEmpty(t.connected_fields)?i.set(""):i.set(n))}}))},W=t=>{const n=!!e(".c-color-palette .color.altered").length;let o=!0;return n&&(o=confirm("One or more fields connected to the color palette have been modified. By changing the palette variation you will lose changes to any color made prior to this action.")),!(n&&!o)&&("function"==typeof t&&t(),!0)},$=()=>{const n=e(".c-color-palette__control"),s=(()=>{const e=o("sm_color_palette_variation");if(_.isUndefined(e))return i;const n=e();return t.colorPalettes.variations.hasOwnProperty(n)?n:i})();n.removeClass("active"),n.filter(".variation-"+s).addClass("active"),e(document).on("click",".js-color-palette input",(function(e){W(O.bind(this))||e.preventDefault()})),e('[for*="sm_palette_filter"], [for*="sm_coloration_level"], [for*="sm_color_diversity"], [for*="sm_shuffle_colors"], [for*="sm_dark_mode"]').on("click",(function(e){W()||e.preventDefault()})),e('[name*="sm_coloration_level"]').on("change",B),e('[name*="sm_color_diversity"]').on("change",Q),e('[name*="sm_shuffle_colors"]').on("change",Q),e('[name*="sm_dark_mode"]').on("change",Q),e('[name*="sm_palette_filter"]').on("change",(()=>{v(),Q()}))},q=_.debounce((()=>{e(".sm-palette-filter").each((function(){e(this).find("input").each((function(t,n){const s=e(n),i=s.next("label"),c=s.val();i.find(".sm-color-palette__color").each((function(t,n){const s=e(n),i=s.data("setting"),r=o(i)();s.css("color",S(r,c))}))}))}))}),30);function G(e,t){const n=o(e)(),s=o(t)();o(e).set(s),o(t).set(n)}return o.bind("ready",(function(){s=o.settings.settings,d||(_.each(t.colorPalettes.masterSettingIds,(function(e){c[e]=""})),void 0===t.settingsClone&&(t.settingsClone=e.extend(!0,{},s)),void 0===t.colorPalettes.connectedFieldsCallbacks&&(t.colorPalettes.connectedFieldsCallbacks={}),d=!0),(()=>{const t=e(".c-color-palette"),n=t.find(".c-color-palette__fields").find("input");if(!t.length)return;const s=t.find(".sm-color-palette__color");s.each(((i,r)=>{const a=e(r),l=a.data("setting"),d=n.filter("."+l),_=o(l);if(a.data("target",d),a.hasClass("js-no-picker"))return;d.iris({change:(e,n)=>{const o=n.color.toString();a.css("color",S(o)),c[l]=S(o),_.set(o),"external"!==e.originalEvent.type&&t.find(".sm-color-palette__color."+l).removeClass("altered"),z()}}),a.find(".iris-picker").on("click",(function(e){e.stopPropagation(),e.preventDefault()}));const u=()=>{s.not(a).each((function(t,n){e(n).data("target").not(d).hide()})),d.show().focus()};a.on("click",(e=>{e.stopPropagation(),e.preventDefault(),d.is(":visible")?(d.iris("hide"),d.hide(),s.removeClass("active inactive")):a.is(".altered")?W(u):u()})),d.on("click",(e=>{e.stopPropagation(),e.preventDefault()})),d.on("focus",(n=>{s.not(a).addClass("inactive").removeClass("active"),a.addClass("active").removeClass("inactive"),s.not(a).each((function(t,n){e(n).data("target").iris("hide")}));const o=d.next(".iris-picker"),i=t.find(".c-color-palette__colors").outerWidth(),c=s.filter(":visible"),r=c.index(a);o.css("left",(i-200)*r/(c.length-1)),I(),d.iris("show")})),d.on("focusout",(e=>{j()}))})),e("body").on("click",(function(){s.removeClass("active inactive"),s.each((function(t,n){const o=e(n).data("target");e(n).hasClass("js-no-picker")||o.iris("hide"),o.hide()}))}))})(),E(),v(),b(),k(),x(),q(),function(){const t=e(document);t.on("click",'[data-action="sm_swap_colors"]',(function(e){e.preventDefault(),G("sm_color_primary","sm_color_secondary")})),t.on("click",'[data-action="sm_swap_dark_light"]',(function(e){e.preventDefault(),G("sm_dark_primary","sm_light_primary"),G("sm_dark_secondary","sm_light_secondary"),G("sm_dark_tertiary","sm_light_tertiary")})),t.on("click",'[data-action="sm_swap_colors_dark"]',(function(e){e.preventDefault(),G("sm_color_primary","sm_dark_primary"),G("sm_color_secondary","sm_dark_secondary"),G("sm_color_tertiary","sm_dark_tertiary")})),t.on("click",'[data-action="sm_swap_secondary_colors_dark"]',(function(e){e.preventDefault(),G("sm_color_secondary","sm_dark_secondary")}))}(),$()})),{}}())}(jQuery,customify,wp);