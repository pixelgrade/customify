window.customify=window.customify||parent.customify||{},function(e,t,n){var o=["sm_accent_color_master","sm_text_color_master","sm_titles_color_master","sm_background_color_master"];void 0===t.colorPalettes&&(t.colorPalettes={}),_.extend(t.colorPalettes,function(){const s=n.customize;let i;const c={};let r=!1;const a=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];function l(e){return isNaN(e)?"00":a[(e-e%16)/16]+a[e%16]}function d(e){return"#"+l(e[0])+l(e[1])+l(e[2])}function u(e){return d(b(e.hue,e.saturation,e.lightness))}function f(e){let t=0,n=0,o=0,s=0;/^#([A-Fa-f0-9]{3,4}){1,2}$/.test(e)&&(3===(e=e.substring(1).split("")).length&&(e=[e[0],e[0],e[1],e[1],e[2],e[2],"F","F"]),4===e.length&&(e=[e[0],e[0],e[1],e[1],e[2],e[2],e[3],e[3]]),t=parseInt([e[0],e[1]].join(""),16),n=parseInt([e[2],e[3]].join(""),16),o=parseInt([e[4],e[5]].join(""),16),s=parseInt([e[6],e[7]].join(""),16));const i=m(t,n,o);return{red:t,green:n,blue:o,alpha:s,hue:i[0],saturation:i[1],lightness:i[2],luma:.2126*t+.7152*n+.0722*o}}function m(e,t,n){e/=255,t/=255,n/=255;const o=Math.max(e,t,n),s=Math.min(e,t,n);let i,c,r=(o+s)/2;if(o==s)i=c=0;else{const a=o-s;switch(c=r>.5?a/(2-o-s):a/(o+s),o){case e:i=(t-n)/a+(t<n?6:0);break;case t:i=(n-e)/a+2;break;case n:i=(e-t)/a+4}i/=6}return[i,c,r]}const h=()=>{_.each(t.colorPalettes.masterSettingIds,(function(e){const t=s(e);if(void 0!==t){const n=t();c[e]=P(n)}}))},g=e=>c[e],p=function(){var e=t.colorPalettes.masterSettingIds.concat(o);_.each(e,(function(e){if(void 0!==i[e]){const n=i[e],c=s(e);_.isUndefined(n.connected_fields)||(t.colorPalettes.connectedFieldsCallbacks[e]=function(e,t){return function(n,i){const c=_.includes(o,t)?n:g(t);_.each(e.connected_fields,(function(e){if(_.isUndefined(e)||_.isUndefined(e.setting_id)||!_.isString(e.setting_id))return;const t=s(e.setting_id);_.isUndefined(t)||t.set(c)})),Q();const r=s(t+"_final");_.isUndefined(r)||(_.isUndefined(e.connected_fields)||_.isEmpty(e.connected_fields)?r.set(""):r.set(c))}}(n,e),c.bind(t.colorPalettes.connectedFieldsCallbacks[e]),_.each(n.connected_fields,(function(e){const n=e.setting_id,o=s(n);void 0!==o&&(t.colorPalettes.connectedFieldsCallbacks[n]=I,o.bind(t.colorPalettes.connectedFieldsCallbacks[n]))})))}}))},v=function(){_.each(t.colorPalettes.connectedFieldsCallbacks,(function(e,t){s(t).unbind(e)})),t.colorPalettes.connectedFieldsCallbacks={}},y=e=>t.colorPalettes.variations.hasOwnProperty(e)?t.colorPalettes.variations[e]:"light",k=()=>{const e=[];return _.each(t.colorPalettes.masterSettingIds,(function(t){const n=s(t)();e.push(n)})),e};function b(e,t,n){let o,s,i;if(0==t)o=s=i=n;else{const c=function(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e},r=n<.5?n*(1+t):n+t-n*t,a=2*n-r;o=c(a,r,e+1/3),s=c(a,r,e),i=c(a,r,e-1/3)}return[Math.round(255*o),Math.round(255*s),Math.round(255*i)]}function F(e,t,n,o){return t[e]*(1-o)+n[e]*o}function C(e,t,n){return e*(1-n)+t*n}const P=(t,n)=>{n=void 0===n?e('[name*="sm_palette_filter"]:checked').val():n;let o=f(t);const s=k(),i=s.slice(0,3),c=s.slice(3,6);M(J(s)),M(J(i)),M(J(c));if("vivid"===n)return o=b(o.hue,C(o.saturation,1,.5),o.lightness),d(o);if("warm"===n&&t!==s[0]){let e=f("#704214");return e.saturation=F("saturation",e,o,1),e.lightness=F("lightness",e,o,1),e=f(u(e)),o.saturation=.75*o.saturation,o=f(u(o)),a=e,l=(l=.75)||.5,(r=o).red=parseInt(a.red*l+r.red*(1-l),10),r.green=parseInt(a.green*l+r.green*(1-l),10),r.blue=parseInt(a.blue*l+r.blue*(1-l),10),o=f(d([r.red,r.green,r.blue])),o.lightness=F("lightness",o,f(o.lightness>.5?"#FFF":"#000"),.2),u(o)}var r,a,l;if("softer"===n)return o.saturation=F("saturation",o,f("#FFF"),.3),o.lightness=F("lightness",o,f("#FFF"),.1),u(o);if("pastel"===n)return o.saturation=F("saturation",o,f("#FFF"),.6),o.lightness=F("lightness",o,f("#FFF"),.2),u(o);if("greyish"===n)return o=b(o.hue,C(o.saturation,0,.8),o.lightness),d(o);if("clarendon"===n)return t===s[0]||t===s[1]||t===s[2]?(o=b(o.hue,C(o.saturation,1,.3),o.lightness),d(o)):(t!==s[3]&&t!==s[4]&&t!==s[5]||(o.lightness=F("lightness",o,f("#000"),.4)),t!==s[6]&&t!==s[7]&&t!==s[8]||(o.lightness=F("lightness",o,f("#FFF"),.4)),u(o));if("cold"===n&&t!==s[0]){const e=.55;o.saturation=F("saturation",o,f("#FFF"),.4),o.hue=(o.hue-e)/18+e,o=f(u(o));const t=m(o.red,o.green,o.blue);return o.hue=t[0],o.saturation=C(t[1],1,.1),o.lightness=F("lightness",o,f(o.lightness>.5?"#FFF":"#000"),.2),u(o)}return"dumb"===n?t===s[1]||t===s[2]?(o=f(s[0]),o.lightness=F("lightness",o,f("#000"),.2),o.saturation=F("saturation",o,f("#000"),.2),t===s[2]&&(o.lightness=F("lightness",o,f("#000"),.2),o.saturation=F("saturation",o,f("#000"),.2)),u(o)):(o.hue=f(s[0]).hue,u(o)):"mayfair"===n?t===s[1]||t===s[2]?(o=f(s[0]),o.hue=(o.hue+.05)%1,t===s[2]&&(o.hue=(o.hue+.05)%1),u(o)):(o.hue=f(s[0]).hue,u(o)):"sierra"===n?t===s[1]||t===s[2]?(o=f(s[0]),o.hue=(o.hue+.95)%1,t===s[2]&&(o.hue=(o.hue+.95)%1),u(o)):(o.hue=f(s[0]).hue,u(o)):t},U=function(){_.each(t.colorPalettes.masterSettingIds,(function(t){e(".c-color-palette").find(".sm-color-palette__color."+t).css("color",g(t))}))},w=function(){_.each(t.colorPalettes.masterSettingIds,(function(t){const n=s(t)();e(".c-color-palette").find(".sm-color-palette__color."+t).css("color",n)}))},S=function(){e(this).trigger("customify:preset-change"),h(),A()},j=_.debounce(()=>{let n=e();_.each(t.colorPalettes.masterSettingIds,(function(t){if(void 0!==i[t]){const o=i[t];_.isUndefined(o.connected_fields)||_.each(o.connected_fields,(function(t){const o=t.setting_id.match(/\[(.*?)\]/);if(o){const t=o[1],s=e(".customize-control-color").filter('[id*="'+t+'"]').find(".wp-color-picker");n=n.add(s)}}))}})),n.iris({palettes:k()})},30),I=_.debounce(()=>{const n=[];let o;_.each(t.colorPalettes.masterSettingIds,(function(e){let t=i[e].connected_fields;const o=s(e)();let c=!1;_.isUndefined(t)||Array.isArray(t)||(t=Object.keys(t).map((function(e){return t[e]}))),!_.isUndefined(t)&&t.length&&(_.each(t,(function(e){const t=e.setting_id,n=s(t);if(void 0!==n){const e=n();"string"==typeof e&&e.toLowerCase()!==P(o).toLowerCase()&&(c=!0)}})),c&&n.push(e))})),o="."+n.join(", ."),e(".c-color-palette .color").removeClass("altered"),n.length&&e(".c-color-palette .color").filter(o).addClass("altered")},30),O=_.debounce(()=>{const n=[];let o;_.each(t.colorPalettes.masterSettingIds,(function(e){const t=i[e].connected_fields;_.isUndefined(t)||_.isEmpty(t)||n.push(e)})),o=_.isEmpty(n)?"*":"."+n.join(", ."),e(".sm-palette-filter .color").addClass("hidden").filter(o).removeClass("hidden"),e(".sm-color-palette__color").addClass("hidden").filter(o).removeClass("hidden"),e(".js-color-palette .palette__item").addClass("hidden").filter(o).removeClass("hidden")},30),x=()=>{I(),O(),j(),U()},z=(e,t)=>{const n=JSON.parse(JSON.stringify(e)),o=JSON.parse(JSON.stringify(e));return _.each(t,(function(e,t){if(void 0!==n[t]){let s=[];e instanceof Array&&_.each(e,(function(e){let t;_.isUndefined(o[e].connected_fields)&&(o[e].connected_fields=[]),t=Object.values(o[e].connected_fields),s=s.concat(t)})),n[t].connected_fields=Object.keys(s).map((function(e){return s[e]}))}})),_.clone(n)},D=(e,t,n,o)=>{const s=_.clone(e);if(!_.isUndefined(s[n])&&!_.isUndefined(s[t])){_.isUndefined(s[t].connected_fields)&&(s[t].connected_fields=[]),_.isUndefined(s[n].connected_fields)&&(s[n].connected_fields=[]);const e=Object.values(s[t].connected_fields),i=Object.values(s[n].connected_fields).concat(e),c=Math.round(o*i.length);let r=i.slice(0,c);const a=i.slice(c);r=Object.keys(r).map((function(e){return r[e]})),r=Object.keys(r).map((function(e){return r[e]})),s[n].connected_fields=r,s[t].connected_fields=a}return s},N=()=>{let n=JSON.parse(JSON.stringify(t.settingsClone));const c=e('[name*="sm_color_diversity"]'),r=e('[name*="sm_coloration_level"]'),a=!!c.length,l=void 0!==c.filter(":checked").data("default"),d=!a||l,u=!!r.length,f=void 0!==e('[name*="sm_coloration_level"]:checked').data("default"),m=!u||f,h=a?e('[name*="sm_color_diversity"]:checked').val():s("sm_color_diversity")();if(!d||!m){const t=e("#_customize-input-sm_dark_color_primary_slider_control").val()/100,o=e("#_customize-input-sm_dark_color_secondary_slider_control").val()/100,s=e("#_customize-input-sm_dark_color_tertiary_slider_control").val()/100;n=D(n,"sm_dark_primary","sm_color_primary",t),n=D(n,"sm_dark_secondary","sm_color_secondary",o),n=D(n,"sm_dark_tertiary","sm_color_tertiary",s),n=D(n,"sm_accent_color_master","sm_text_color_master",s),console.log(n.sm_accent_color_master,n.sm_text_color_master);const i=y("color_diversity_low");n=z(n,i),"medium"===h&&(n=D(n,"sm_color_primary","sm_color_secondary",.5)),"high"===h&&(n=D(n,"sm_color_primary","sm_color_secondary",.67),n=D(n,"sm_color_secondary","sm_color_tertiary",.5))}const g=e('[name*="sm_shuffle_colors"]:checked').val();if("default"!==g){const e=y("shuffle_"+g);n=z(n,e)}if("on"===e('[name*="sm_dark_mode_control"]:checked').val()){const e=y("dark");n=z(n,e)}var p=t.colorPalettes.masterSettingIds.concat(o);_.each(p,(function(e){i[e]=n[e]}))},J=function(e){const t=[];return _.each(e,(function(e){t.push(f(e))})),t},M=function(e){const t={red:0,green:0,blue:0,alpha:0,hue:0,saturation:0,lightness:0,luma:0};for(let n=0;n<e.length;n++){const o=e[n];for(let e in t)t[e]+=o[e]}for(let n in t)t[n]/=e.length;return t},E=()=>{const n=e('[name*="sm_coloration_level"]:checked').val();if(void 0!==e('[name*="sm_coloration_level"]:checked').data("default")){const n=["sm_dark_color_primary_slider","sm_dark_color_secondary_slider","sm_dark_color_tertiary_slider"];_.each(n,(function(n){const o=t.config.settings[n];s(n).set(o.default),e("#_customize-input-"+n+"_control ").val(o.default)}))}else{const t=parseFloat(n);e("#_customize-input-sm_dark_color_primary_slider_control, #_customize-input-sm_dark_color_secondary_slider_control, #_customize-input-sm_dark_color_tertiary_slider_control").val(t)}A()},A=()=>{N(),v(),p(),x(),_.each(t.colorPalettes.masterSettingIds,(function(e){if(void 0!==s(e)){let t=i[e];const n=g(e);_.each(t.connected_fields,(function(e){if(_.isUndefined(e)||_.isUndefined(e.setting_id)||!_.isString(e.setting_id))return;const t=s(e.setting_id);_.isUndefined(t)||t.set(n)}));const o=s(e+"_final");_.isUndefined(o)||(_.isUndefined(t.connected_fields)||_.isEmpty(t.connected_fields)?o.set(""):o.set(n))}}))},L=t=>{const n=!!e(".c-color-palette .color.altered").length;let o=!0;return n&&(o=confirm("One or more fields connected to the color palette have been modified. By changing the palette variation you will lose changes to any color made prior to this action.")),!(n&&!o)&&("function"==typeof t&&t(),!0)},B=()=>{const n=e(".c-color-palette__control"),o=(()=>{const e=s("sm_color_palette_variation");if(_.isUndefined(e))return"light";const n=e();return t.colorPalettes.variations.hasOwnProperty(n)?n:"light"})();n.removeClass("active"),n.filter(".variation-"+o).addClass("active"),e(document).on("click",".js-color-palette input",(function(e){L(S.bind(this))||e.preventDefault()})),e('[for*="sm_palette_filter"], [for*="sm_coloration_level"], [for*="sm_color_diversity"], [for*="sm_shuffle_colors"], [for*="sm_dark_mode"]').on("click",(function(e){L()||e.preventDefault()})),e('[name*="sm_coloration_level"]').on("change",E),e('[name*="sm_color_diversity"]').on("change",A),e('[name*="sm_shuffle_colors"]').on("change",A),e('[name*="sm_dark_mode"]').on("change",A),e('[name*="sm_palette_filter"]').on("change",()=>{h(),A()})},Q=_.debounce(()=>{e(".sm-palette-filter").each((function(){e(this).find("input").each((function(t,n){const o=e(n),i=o.next("label"),c=o.val();i.find(".sm-color-palette__color").each((function(t,n){const o=e(n),i=o.data("setting"),r=s(i)();o.css("color",P(r,c))}))}))}))},30);function W(e,t){const n=s(e)(),o=s(t)();s(e).set(o),s(t).set(n)}return s.bind("ready",(function(){i=s.settings.settings,r||(_.each(t.colorPalettes.masterSettingIds,(function(e){c[e]=""})),void 0===t.settingsClone&&(t.settingsClone=e.extend(!0,{},i)),void 0===t.colorPalettes.connectedFieldsCallbacks&&(t.colorPalettes.connectedFieldsCallbacks={}),r=!0),(()=>{const t=e(".c-color-palette"),n=t.find(".c-color-palette__fields").find("input");if(!t.length)return;const o=t.find(".sm-color-palette__color");o.each((i,r)=>{const a=e(r),l=a.data("setting"),d=n.filter("."+l),_=s(l);if(a.data("target",d),a.hasClass("js-no-picker"))return;d.iris({change:(e,n)=>{const o=n.color.toString();a.css("color",P(o)),c[l]=P(o),_.set(o),"external"!==e.originalEvent.type&&t.find(".sm-color-palette__color."+l).removeClass("altered"),j()}}),a.find(".iris-picker").on("click",(function(e){e.stopPropagation(),e.preventDefault()}));const u=()=>{o.not(a).each((function(t,n){e(n).data("target").not(d).hide()})),d.show().focus()};a.on("click",e=>{e.stopPropagation(),e.preventDefault(),d.is(":visible")?(d.iris("hide"),d.hide(),o.removeClass("active inactive")):a.is(".altered")?L(u):u()}),d.on("click",e=>{e.stopPropagation(),e.preventDefault()}),d.on("focus",n=>{o.not(a).addClass("inactive").removeClass("active"),a.addClass("active").removeClass("inactive"),o.not(a).each((function(t,n){e(n).data("target").iris("hide")}));const s=d.next(".iris-picker"),i=t.find(".c-color-palette__colors").outerWidth(),c=o.filter(":visible"),r=c.index(a);s.css("left",(i-200)*r/(c.length-1)),w(),d.iris("show")}),d.on("focusout",e=>{U()})}),e("body").on("click",(function(){o.removeClass("active inactive"),o.each((function(t,n){const o=e(n).data("target");e(n).hasClass("js-no-picker")||o.iris("hide"),o.hide()}))}))})(),N(),h(),v(),p(),x(),Q(),function(){const t=e(document);t.on("click",'[data-action="sm_swap_colors"]',(function(e){e.preventDefault(),W("sm_color_primary","sm_color_secondary")})),t.on("click",'[data-action="sm_swap_dark_light"]',(function(e){e.preventDefault(),W("sm_dark_primary","sm_light_primary"),W("sm_dark_secondary","sm_light_secondary"),W("sm_dark_tertiary","sm_light_tertiary")})),t.on("click",'[data-action="sm_swap_colors_dark"]',(function(e){e.preventDefault(),W("sm_color_primary","sm_dark_primary"),W("sm_color_secondary","sm_dark_secondary"),W("sm_color_tertiary","sm_dark_tertiary")})),t.on("click",'[data-action="sm_swap_secondary_colors_dark"]',(function(e){e.preventDefault(),W("sm_color_secondary","sm_dark_secondary")}))}(),B()})),{}}())}(jQuery,customify,wp);